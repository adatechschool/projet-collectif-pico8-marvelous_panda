pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
 create_player()
end

function _update()
 player_mouvement()
 update_camera()
 interact(x,y)
end

function _draw()
	cls(3)
	palt(0,false)
	palt(12,true)
	draw_map()
	draw_player()
	draw_ui()
	palt()
end
-->8
--map

function draw_map()
	map(0,0,0,0,128,64)
end

function check_flag(flag,x,y)
 local sprite=mget(x,y)
 return fget(sprite,flag)
end


function update_camera()
 local map_width=127
 local map_height=63
 local camx=mid(0,(p.x-7.5)*8+p.ox,
            (map_width-15)*8)
 local camy=mid(0,(p.y-7.5)*8+p.oy,
            (map_height-15)*8)    
 camera(camx,camy)
end
 
--function update_camera()
-- local camx=flr(p.x/16)*16
-- local camy=flr(p.y/16)*16
-- camera(camx*8,camy*8)
--end

function next_tile(x,y)
 local sprite=mget(x,y)
 mset(x,y,sprite+1)
end




-->8
--player

function create_player()
 p={
   x=5,y=25,
   ox=0,oy=0,
   start_ox=0,start_oy=0,
   anim_t=0,
   sprite=20,
   oeufs=0
   }
end

function player_mouvement()
 newx=p.x
 newy=p.y
 if p.anim_t==0 then
    newox=0
    newoy=0
  if btn(⬅️) then
	  newx-=1
	  newox=8
	  p.flip=true
	 elseif btn(➡️) then
	  newx+=1
	  newox=-8
	  p.flip=false
	 elseif btn(⬆️) then
	  newy-=1
	  newoy=8
	 elseif btn(⬇️) then
	 	newy+=1
	  newoy=-8
	 end
 end
 if p.anim_t>=0.5 then
  p.sprite=21
 else
  p.sprite=20
 end
  
 
 interact(newx,newy)
 
 if (newx!=p.x or newy!=p.y)
  and not
   check_flag(0,newx,newy)
 then
  p.x=mid(0,newx,47)
  p.y=mid(0,newy,31)
  p.start_ox=newox
  p.start_oy=newoy
  p.anim_t=1
 end
 p.anim_t=max(p.anim_t-0.125,0)
 p.ox=p.start_ox*p.anim_t
 p.oy=p.start_oy*p.anim_t

end 

function draw_player()
	spr(p.sprite,p.x*8+p.ox,
	    p.y*8+p.oy,1,1,p.flip)
end

-->8
--oeuf
function pick_up_oeuf(x,y)
 next_tile(x,y)
 p.oeufs+=1
end

function interact(x,y)
	if check_flag(1,x,y) then
	 pick_up_oeuf(x,y)
	elseif check_flag(2,x,y)
	and p.oeufs>0 then
		open_door_poule(x,y)
 end
end

function draw_ui()
	camera()
 spr(15)
 print("X"..p.oeufs,10,2,7)
end

-->8
-- open_door

function open_door_poule(x,y)
	next_tile(x,y)
	p.oeufs-=1
end

__gfx__
00000000cccccccccccccccc33333333ccbbbcccbbbbbbbb11111111cc0cc0cb9ccc9cccccc777cccccc8cccccaccaccccdccdcccc9cc9cc00999900cccaaccc
00000000cccccccccccccccc33333333cccbccccbbbbbbbb11111111cc7777cb99c999c9cc77c7cccc7777ccccaaaacccc7dd7cccc7997cc09900990ccaaaacc
00000000cccc00cccc00cccc33333333cccbccccbbb7bbbb11111111cc7070cb99c999c977ccc777cc7070cccc0aa0cccc0dd0cccc9090cc99000099caaaaaac
00700700cccc00cccc00cccc33333333cccbccccbb7a7bbb11111111cc7777cb999999997cccccc7cc777accacaaaacccc7447cc0c9999c090000009aaaaaaaa
00077000cccc77777777cccc33333333cccbccccbbb7bbbb11111111c000000099c999c97cccccc77aa77877caaaaaaccddddddc9c99990990000009aaaaaaaa
00077000ccc7777777777ccc33333333cccbccccbbbbb9bb111111110c7777cb99c999c97cccccc7c7a7777ccca77acadd0dd0dd099779cc99000009aaaaaaaa
00700700cc777007700777cc33333333cccbccccbbbb9a9b11111111cc0770cc99c999c97cccccc7cc7777cccca77acccddddddccc0770cc09900099aaaaaaaa
00000000cc777007700777cc33333333ccbbbcccbbbbb9bb11111111cc0cc0cc99c999c97cccccc7ccaccaccccaccacccc0dd0cccc9cc9cc00999990caaaaaac
33333333cc777777777777cccc9cc9cccc0cc0cccc0cc0ccbbbbbbbb0000000000000000cccccccc000000000000000000000000000000000000000000000000
33333333cccc00777700cccccc9999cccc7777cccc7777ccbbbbbb000000000000000000ccc88ccc000000000000000000000000000000000000000000000000
33333333cccc77777777cccccc9070cccc7070cccc7070ccbbb000030000000000000000cc8cc8cc000000000000000000000000000000000000000000000000
33333333c00077777777000c9c9777c9cc7777cccc7777ccbbb033330000000000000000c8cccc8c000000000000000000000000000000000000000000000000
33333333cc007777777700cc9c77779cc000000cc000000c000033330000000000000000c8cccc8c000000000000000000000000000000000000000000000000
33333333cccc777cc777cccc997777cc0c7777c0c077770c033333b30000000000000000c8cccc8c000000000000000000000000000000000000000000000000
33333333cccc000cc000cccccc9999cccc0770cccc7070cc33333bbb0000000000000000c8cccc8c000000000000000000000000000000000000000000000000
33333333cccccccccccccccccc9cc9cccc0cc0ccccc0c0cc333b3bb30000000000000000c8cccc8c000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
30303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030300000000000
__gff__
0000000000000000010000000000000200000100000000000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0303030303030303030303030303030303030303030308030303030308030303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303080808030303030803030303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303080303030303030808030303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303080303030303030308030303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03030303030303030303030303030303030303080803030303030303080303030303030303030d0303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03030303030e0303030303030303030303030808030303030303030308030303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030908080303030303030303030303080808030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303090303030303030303030303030303030308030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030308030303030303030303030303030303030303090903030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303080808030303030303030303030303030303030303030308080803030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303080808030303030303030303030303030808080808030303030303030808080808080808080808080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080808080303030303030303030303030303080303030308030303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303090909030303030303080303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030303090303030303030303080303030303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030308030303030303030303080303030303080808080808080808080808080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
03030303030303030303030303030303030308030303030c0303030308080303030303030903030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303030803030303030303030808030303030303030903030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303080303030303030303080803030303030303030903030303130303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303030303080303030303030308080303030303030303080803030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808030303030303030303030303030303080303030303030808030303030303030303030808030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303080808080808080909080303030303030808030308080803031908080808030303030308080808080808080808080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303080803030303030308080803030303190303030308080303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030803030303030303030303030308030303030303080303030303030303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030803030303030303030303080808030303030303080803030303030303030303080808080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030f03030303030808030303030303030808080303030303030303030803030303090909080808030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030308030303030303030803030303030303030303030803030303080303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030308030303030303080303030303030303030303030308030303080303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030308080303030303080303030303030a03030303030308030303080303030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
030303030303030303030303030308030303030308080303030303030303030303030803030308030303030b030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303030303030303030303080803030303030803030303030303030303030308030303080803030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303090903030303030303030803030303030803030303030303030303030308030303030803030303030303080303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080808080303030303030303030303000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
